# SaitaMaze

実行時間制限：2 sec

## 問題文

Maximum 君は $H × W$ マスの広大な埼玉大学に閉じ込められています。\
それぞれのマスの高さは $h_{i,j}$ です。\
埼玉大学から脱出するには、現在地 $(0, 0)$ から出口の $(H-1, W-1)$ に移動する必要があります。しかし、埼玉大学の地形は非常に険しく、同じ高さの隣接マスに限り直接移動することができます。

Maximum 君は魔力を 1 消費することで、任意のマスの高さを変更する特殊能力を持っています。
$(0, 0)$ から $(H-1, W-1)$ に到達する際に消費する魔力の最小値を求めてください。

## 制約

- $1 \leq H,W \leq 100$
- $1 \leq h_{i,j} \leq 10^9$
- $h_{i,j}$ が等しい地点 $(i,j)$ は各値毎に最大で **100** 個まで存在する。

## 部分点

この問題はいくつかの小課題に分けられ、その小課題の全てのテストケースに正解した場合に、「この小課題に正解した」とみなされます。
提出したソースコードの得点は、正解した小課題の点数の合計となります。

1. （1 点） $h_{i,j}$ が等しい地点 $(i,j)$ は**存在しない**。
2. （99 点） 追加の制約はない。

## 入力

$H \ W$ \
$h_{1,1} h_{1,2} ... h_{1,W}$ \
$h_{2,1} h_{2,2} ... h_{2,W}$ \
$:$ \
$h_{H,1} h_{H,2} ... h_{H,W}$

## 出力

$(0, 0)$ から $(H-1, W-1)$ に到達する際に消費する魔力の最小値

### 入力例 1

```txt
4 4
10000 10001 10010 10011
10100 10101 10110 10111
11000 11001 11010 11011
11100 11101 11110 11111
```

### 出力例 1

```txt
6
```

最適にマスの高さを変更すると、6 回の特殊能力を使うことで $(0, 0)$ から $(H-1, W-1)$ に到達できます。
なお、この入力例は小課題 1, 2 の制約を満たします。

### 入力例 2

```txt
5 5
1 4 5 5 5
1 4 2 2 3
1 4 2 6 3
1 1 2 6 3
4 4 5 5 3
```

### 出力例 2

```txt
2
```

この入力例は小課題 2 の制約を満たします。

### 入力例 3

```txt
10 10
3 1 4 1 5 9 2 6 5 3
5 8 9 7 9 3 2 3 8 4
6 2 6 4 3 3 8 3 2 7
9 5 7 2 8 8 4 1 9 7
1 6 9 3 9 9 3 7 5 1
2 5 8 2 1 9 7 9 4 4
5 9 2 3 7 7 8 1 6 4
4 6 2 8 6 2 5 8 9 9
8 6 2 8 9 3 4 8 2 5
3 4 2 1 1 7 2 6 7 9
```

### 出力例 3

```txt
10
```

この入力例は小課題 2 の制約を満たします。

## 解法

- `sol-cpp-partial1`: C++ 部分点 1
- `sol-py-partial1`: Python 部分点 1
- `sol-cpp-ac`: C++ AC
- `sol-py-ac`: Python AC

### 部分点 1 解法

ある地点 $(si,sj)$ から $(ti,tj)$ に移動する場合、道中のいずれかに合わせて高さを変更すると $|s_i-t_i|+|s_j-t_j|-1$ だけ魔力を消費することで $(si,sj)$ から $(ti,tj)$ に移動することができます。
したがって、全ての地点の高さが異なる場合、 $|s_i-t_i|+|s_j-t_j|$ が消費する魔力の最小値となります。

### 部分点 2 解法

同じ高さの地点が存在する場合は、以下の事実があります。

- ある地点 $(si,sj)$ から $(ti,tj)$ に移動する際に、 $h_{s_i,s_j} = h_{t_i,t_j}$ である場合、道中の開始点・到達点を除いた $|s_i-t_i|+|s_j-t_j|-1$ 個の地点の高さを変更することで、 $(si,sj)$ から $(ti,tj)$ に同じ高さの道を作ることができる。

ここで以下のグラフを考えます。

1. ある地点 $(i,j)$ において、上下左右にコスト 1 で辺を張る。
2. ある二つの地点 $(i,j)$ と $(i',j')$ において、 $h_{i,j} = h_{i',j'}$ である場合、 $(i,j)$ から $(i',j')$ にコスト $|i-i'|+|j-j'|-1$ で辺を張る。

1 の辺は $2  (H-1)  W + 2  H  (W-1)$ 本存在します。\
2 の辺は同じ高さの地点が最大で 100 個まで存在するという制約より、最大でも辺の本数は $\dfrac{HW}{100} 100 (100-1) \leq 10^6$ となります。

したがって、ダイクストラ法を用いて最短経路問題を解くことで、辺の本数を $E$ として $O(E \log HW)$ の計算量で解くことができます。
